name: Production Build Check

on:
  push:
    branches: [ main, master, develop ]
  pull_request:
    branches: [ main, master, develop ]

jobs:
  test-builds:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v3
      
    - name: Test Backend Build
      run: |
        echo "ðŸ”¨ Building Backend..."
        docker build -f backend/Dockerfile --target production backend/
        
    - name: Test Frontend Build
      run: |
        echo "ðŸ”¨ Building Frontend..."
        docker build -f frontend/Dockerfile --target runner frontend/
        
    - name: Build Summary
      if: success()
      run: |
        echo "âœ… All production builds successful!"
        echo "Safe to deploy to Render."